.PHONY: help setup build test deploy clean start stop restart logs status

# Default target
help:
	@echo "ğŸ¬ Inferloop SynthData Video Pipeline"
	@echo ""
	@echo "Available targets:"
	@echo "  setup     - Setup development environment"
	@echo "  build     - Build all services"
	@echo "  test      - Run all tests"
	@echo "  deploy    - Deploy to local environment"
	@echo "  start     - Start all services"
	@echo "  stop      - Stop all services"
	@echo "  restart   - Restart all services"
	@echo "  logs      - Show logs for all services"
	@echo "  status    - Show status of all services"
	@echo "  clean     - Clean up resources"

setup:
	@echo "ğŸ”§ Setting up development environment..."
	./scripts/setup/dev-environment.sh

build:
	@echo "ğŸ—ï¸ Building all services..."
	docker-compose build

test:
	@echo "ğŸ§ª Running tests..."
	./scripts/setup/run-tests.sh

deploy: build
	@echo "ğŸš€ Deploying local stack..."
	./scripts/deployment/local-deploy.sh

start:
	@echo "â–¶ï¸ Starting all services..."
	docker-compose up -d

stop:
	@echo "â¹ï¸ Stopping all services..."
	docker-compose down

restart: stop start

logs:
	@echo "ğŸ“‹ Showing logs..."
	docker-compose logs -f

status:
	@echo "ğŸ“Š Service status..."
	docker-compose ps
	@echo ""
	@echo "ğŸ” Running health checks..."
	./scripts/deployment/health-check.sh

clean:
	@echo "ğŸ§¹ Cleaning up..."
	docker-compose down -v
	docker system prune -f
	@echo "âœ… Cleanup complete"

# Development helpers
dev-start:
	@echo "ğŸ”§ Starting development environment..."
	docker-compose up -d redis postgres minio kafka zookeeper
	@echo "âœ… Infrastructure services started"

dev-stop:
	@echo "ğŸ”§ Stopping development environment..."
	docker-compose down

# Production helpers
prod-deploy:
	@echo "ğŸš€ Deploying to production..."
	kubectl apply -f infrastructure/kubernetes/manifests/

prod-status:
	@echo "ğŸ“Š Production status..."
	kubectl get pods -n video-pipeline